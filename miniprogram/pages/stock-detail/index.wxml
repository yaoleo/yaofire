<!-- è‚¡ç¥¨è¯¦æƒ…é¡µ -->
<view class="page">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header" wx:if="{{stock && latestPrice}}">
    <view class="stock-title">
      <text class="symbol">{{stock.symbol}}</text>
      <text class="name">{{stock.name}}</text>
    </view>

    <view class="price-info">
      <text class="current-price">${{latestPrice.close.toFixed(2)}}</text>
      <text class="change {{latestPrice.changePercent >= 0 ? 'up' : 'down'}}">
        {{latestPrice.changePercent >= 0 ? 'ğŸ“ˆ +' : 'ğŸ“‰ '}}{{latestPrice.changePercent.toFixed(2)}}%
      </text>
    </view>

    <view class="price-details">
      <view class="detail-item">
        <text class="label">å¼€ç›˜</text>
        <text class="value">${{latestPrice.open.toFixed(2)}}</text>
      </view>
      <view class="detail-item">
        <text class="label">æœ€é«˜</text>
        <text class="value">${{latestPrice.high.toFixed(2)}}</text>
      </view>
      <view class="detail-item">
        <text class="label">æœ€ä½</text>
        <text class="value">${{latestPrice.low.toFixed(2)}}</text>
      </view>
      <view class="detail-item">
        <text class="label">æˆäº¤é‡</text>
        <text class="value">{{(latestPrice.volume / 1000000).toFixed(1)}}M</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view class="error" wx:if="{{error && !loading}}">
    <text>{{error}}</text>
    <button bindtap="loadDetail">é‡è¯•</button>
  </view>

  <!-- å†å²æ•°æ® -->
  <view class="history-section" wx:if="{{!loading && history.length > 0}}">
    <view class="section-title">
      <text>è¿‘ 30 æ—¥ä»·æ ¼èµ°åŠ¿</text>
    </view>

    <view class="price-list">
      <view class="price-item" wx:for="{{history}}" wx:key="date">
        <view class="item-date">
          <text>{{item.date}}</text>
        </view>
        <view class="item-price">
          <text class="close">${{item.close.toFixed(2)}}</text>
          <text class="change {{item.changePercent >= 0 ? 'up' : 'down'}}">
            {{item.changePercent >= 0 ? '+' : ''}}{{item.changePercent.toFixed(2)}}%
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¿¡æ¯é¢æ¿ -->
  <view class="info-panel" wx:if="{{stock}}">
    <view class="info-row">
      <text class="label">å¸‚åœº</text>
      <text class="value">{{stock.market}}</text>
    </view>
    <view class="info-row">
      <text class="label">è¡Œä¸š</text>
      <text class="value">{{stock.sector}}</text>
    </view>
    <view class="info-row">
      <text class="label">ç»†åˆ†è¡Œä¸š</text>
      <text class="value">{{stock.industry}}</text>
    </view>
    <view class="info-row">
      <text class="label">è´§å¸</text>
      <text class="value">{{stock.currency}}</text>
    </view>
  </view>
</view>
